<script type="text/ng-template" id="tree_item.html">
  <tr ng-if="file.directory"><td><input type="checkbox" ng-click="vm.toggleSelection(file)"></td><td><span ng-click="vm.openLocalDirectory(file)"><span class="ion-folder"></span> {{ file.name }} </span><table class="table table-striped" ng-if="file.showFiles"><tbody ng-repeat="file in file.localFiles | orderBy: ['-directory', 'name'] | filter:vm.localFileSearch" ng-include="'tree_item.html'"></tbody></table></td><td><span ng-if="vm.getMatchForPath(file.path)">{{vm.getMatchForPath(file.path).message}}</span></td><td><button class="btn btn-xs btn-success button-icon" ng-if="vm.getMatchForPath(file.path).status == 1" ng-click="vm.addThisFile()">Add this file</button></td></tr>

   <tr ng-if="!file.directory"><td><input type="checkbox" ng-click="vm.toggleSelection(file)"></td><td><span><span class="ion-document"></span> {{ file.name }} </span></td><td><span ng-if="vm.getMatchForPath(file.path)">{{vm.getMatchForPath(file.path).message}}</span></td><td><button class="btn btn-xs btn-success button-icon" ng-if="vm.getMatchForPath(file.path).status == 1" ng-click="vm.addThisFile()">Add this file</button></td></tr>
</script>

<div class="modal-body">
  <legend>
    Create {{vm.mediaType}}s from Files
  </legend>

  <div>
    <div class="form-group">
      <input type="text" ng-model="vm.localFileSearch" class="form-control input-sm"
             placeholder="Search current directory...">
    </div>
  </div>

  <div>
    <!-- <span class="btn btn-default btn-sm" ng-click="vm.backLocalDirectory()" ng-if="vm.localDir.length > 0">
      <span class="ion-android-arrow-back"></span>
    </span>

    <span>{{ vm.localDir.join('/') }}</span> -->

    <table class="table table-striped">
      <thead>
      <tr>
        <th>
          <input type="checkbox" ng-click="vm.toggleSelectAll()">
        </th>
        <th>File/Folder</th>
        <th>Result</th>
        <th>Action</th>
      </tr>
      </thead>
      <tbody ng-repeat="file in vm.localFiles | orderBy: ['-directory', 'name'] | filter:vm.localFileSearch" ng-include="'tree_item.html'">
      </tbody>
      <!-- <tr ng-repeat="file in vm.localFiles | orderBy: ['-directory', 'name'] | filter:vm.localFileSearch">
        <td>
          <input type="checkbox" ng-click="vm.toggleSelection(file)">
        </td>
        <td>
          <span ng-if="file.directory" ng-click="vm.openLocalDirectory(file)">
            <span class="ion-folder"></span>
            {{ file.name }}
          </span>

          <span ng-if="!file.directory">
            <span class="ion-document"></span>
            {{ file.name }}
            </span>
        </td>

        <td>
          <span ng-if="vm.getMatchForPath(file.path)">{{vm.getMatchForPath(file.path).message}}</span>
        </td>
        <td>
          <button class="btn btn-xs btn-success button-icon" ng-if="vm.getMatchForPath(file.path).status == 1" ng-click="vm.addThisFile()">
            Add this file
          </button>
        </td>
      </tr> -->
    </table>
  </div>

</div>

<div class="modal-footer">
  <button class="btn btn-success button-icon" ng-show="vm.matchResult" ng-click="vm.addAllMatches()">
    Add all found matches
  </button>
  <button class="btn btn-success button-icon" ng-disabled="!vm.selection.length" ng-click="vm.runMatcher()">
    Run Matcher
    <i class="ion-load-c spin" ng-show="vm.isMatcherLoading"></i>
  </button>
  <button class="btn btn-default" ng-disabled="vm.isMatcherLoading" ng-click="vm.cancel()">Close</button>
</div>
